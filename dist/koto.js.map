{"version":3,"sources":["koto.js"],"names":[],"mappings":"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","file":"koto.js","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  global.koto = factory()\n}(this, function () { 'use strict';\n\n  class Chart {\n  \tconstructor(selection, chartOptions) {\n  \t\tthis.base = selection;\n      this.hasDrawn = false;\n  \t\tthis._layers = {};\n  \t\tthis._attached = {};\n  \t\tthis._events = {};\n\n  \t\tif (chartOptions && chartOptions.transform) {\n  \t\t\tthis.transform = chartOptions.transform;\n  \t\t}\n  \t}\n\n  \ttransform(data) { return data; }\n\n  \tpreDraw() {}\n\n  \tpostDraw() {}\n\n  \tunlayer(name) {\n  \t\tvar layer = this.layer(name);\n\n  \t\tdelete this._layers[name];\n  \t\tdelete layer._chart;\n\n  \t\treturn layer;\n  \t}\n\n  \tlayer(name, selection, options) {\n  \t\tvar layer;\n\n  \t\tif (arguments.length === 1) {\n  \t\t\treturn this._layers[name];\n  \t\t}\n\n  \t\t// we are reattaching a previous layer, which the\n  \t\t// selection argument is now set to.\n  \t\tif (arguments.length === 2) {\n\n  \t\t\tif (typeof selection.draw === 'function') {\n  \t\t\t\tselection._chart = this;\n  \t\t\t\tthis._layers[name] = selection;\n  \t\t\t\treturn this._layers[name];\n\n  \t\t\t} else {\n  \t\t\t\tkotoAssert(false, 'When reattaching a layer, the second argument '+\n  \t\t\t\t\t'must be a d3.chart layer');\n  \t\t\t}\n  \t\t}\n\n  \t\tlayer = selection.layer(options);\n\n  \t\tthis._layers[name] = layer;\n\n  \t\tselection._chart = this;\n\n  \t\treturn layer;\n  \t}\n\n  \tattach(attachmentName, chart) {\n  \t\tif (arguments.length === 1) {\n  \t\t\treturn this._attached[attachmentName];\n  \t\t}\n\n  \t\tthis._attached[attachmentName] = chart;\n  \t\treturn chart;\n  \t}\n\n  \tdraw(rawData) {\n\n  \t\tvar layerName, attachmentName, attachmentData;\n\n  \t\tvar data = this.transform(rawData);\n\n      this.preDraw(data);\n\n  \t\tfor (layerName in this._layers) {\n  \t\t\tthis._layers[layerName].draw(data);\n  \t\t}\n\n  \t\tfor (attachmentName in this._attached) {\n  \t\t\tif (this.demux) {\n  \t\t\t\tattachmentData = this.demux(attachmentName, data);\n  \t\t\t} else {\n  \t\t\t\tattachmentData = data;\n  \t\t\t}\n  \t\t\tthis._attached[attachmentName].draw(attachmentData);\n  \t\t}\n\n      this.hasDrawn = true;\n\n      this.postDraw(data);\n  \t}\n\n  \ton(name, callback, context) {\n  \t\tvar events = this._events[name] || (this._events[name] = []);\n  \t\tevents.push({\n  \t\t\tcallback: callback,\n  \t\t\tcontext: context || this,\n  \t\t\t_chart: this\n  \t\t});\n  \t\treturn this;\n  \t}\n\n  \tonce(name, callback, context) {\n  \t\tvar self = this;\n  \t\tvar once = function() {\n  \t\t\tself.off(name, once);\n  \t\t\tcallback.apply(this, arguments);\n  \t\t};\n  \t\treturn this.on(name, once, context);\n  \t}\n\n  \toff(name, callback, context) {\n  \t\tvar names, n, events, event, i, j;\n\n  \t\t// remove all events\n  \t\tif (arguments.length === 0) {\n  \t\t\tfor (name in this._events) {\n  \t\t\t\tthis._events[name].length = 0;\n  \t\t\t}\n  \t\t\treturn this;\n  \t\t}\n\n  \t\t// remove all events for a specific name\n  \t\tif (arguments.length === 1) {\n  \t\t\tevents = this._events[name];\n  \t\t\tif (events) {\n  \t\t\t\tevents.length = 0;\n  \t\t\t}\n  \t\t\treturn this;\n  \t\t}\n\n  \t\t// remove all events that match whatever combination of name, context\n  \t\t// and callback.\n  \t\tnames = name ? [name] : Object.keys(this._events);\n  \t\tfor (i = 0; i < names.length; i++) {\n  \t\t\tn = names[i];\n  \t\t\tevents = this._events[n];\n  \t\t\tj = events.length;\n  \t\t\twhile (j--) {\n  \t\t\t\tevent = events[j];\n  \t\t\t\tif ((callback && callback === event.callback) ||\n  \t\t\t\t\t\t(context && context === event.context)) {\n  \t\t\t\t\tevents.splice(j, 1);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\treturn this;\n  \t}\n\n  \ttrigger(name) {\n  \t\tvar args = Array.prototype.slice.call(arguments, 1);\n  \t\tvar events = this._events[name];\n  \t\tvar i, ev;\n\n  \t\tif (events !== undefined) {\n  \t\t\tfor (i = 0; i < events.length; i++) {\n  \t\t\t\tev = events[i];\n  \t\t\t\tev.callback.apply(ev.context, args);\n  \t\t\t}\n  \t\t}\n\n  \t\treturn this;\n  \t}\n  }\n\n  var lifecycleRe = /^(enter|update|merge|exit)(:transition)?$/;\n\n  class Layer {\n  \tconstructor(base) {\n  \t\tthis._base = base;\n  \t\tthis._handlers = {};\n  \t}\n\n  \tdataBind() {\n  \t\tkotoAssert(false, 'Layers must specify a dataBind method.');\n  \t}\n\n  \tinsert() {\n  \t\tkotoAssert(false, 'Layers must specify an `insert` method.');\n  \t}\n\n  \ton(eventName, handler, options) {\n  \t\toptions = options || {};\n\n  \t\tkotoAssert(lifecycleRe.test(eventName),\n  \t\t\t'Unrecognized lifecycle event name specified to `Layer#on`: \\'${eventName}\\'.');\n\n  \t\tif (!(eventName in this._handlers)) {\n  \t\t\tthis._handlers[eventName] = [];\n  \t\t}\n  \t\tthis._handlers[eventName].push({\n  \t\t\tcallback: handler,\n  \t\t\tchart: options.chart || null\n  \t\t});\n  \t\treturn this._base;\n  \t}\n\n  \toff(eventName, handler) {\n\n  \t\tvar handlers = this._handlers[eventName];\n  \t\tvar idx;\n\n  \t\tkotoAssert(lifecycleRe.test(eventName),\n  \t\t\t'Unrecognized lifecycle event name specified to `Layer#on`: \\'${eventName}\\'.');\n\n  \t\tif (!handlers) {\n  \t\t\treturn this._base;\n  \t\t}\n\n  \t\tif (arguments.length === 1) {\n  \t\t\thandlers.length = 0;\n  \t\t\treturn this._base;\n  \t\t}\n\n  \t\tfor (idx = handlers.length - 1; idx > -1; --idx) {\n  \t\t\tif (handlers[idx].callback === handler) {\n  \t\t\t\thandlers.splice(idx, 1);\n  \t\t\t}\n  \t\t}\n  \t\treturn this._base;\n  \t}\n\n  \tdraw(data) {\n  \t\tvar bound, entering, events, selection, method, handlers, eventName, idx, len;\n\n  \t\tbound = this.dataBind.call(this._base, data);\n\n  \t\t// Although `bound instanceof d3.selection` is more explicit, it fails\n  \t\t// in IE8, so we use duck typing to maintain compatability.\n\n  \t\t// d3cAssert(bound && bound.call === d3.selection.prototype.call,\n  \t\t//   'Invalid selection defined by `Layer#dataBind` method.');\n  \t\t// d3cAssert(bound.enter, 'Layer selection not properly bound.');\n\n  \t\tentering = bound.enter();\n  \t\tentering._chart = this._base._chart;\n\n  \t\tevents = [\n  \t\t\t{\n  \t\t\t\tname: 'update',\n  \t\t\t\tselection: bound\n  \t\t\t},\n  \t\t\t{\n  \t\t\t\tname: 'enter',\n  \t\t\t\tselection: entering,\n  \t\t\t\tmethod: this.insert\n  \t\t\t},\n  \t\t\t{\n  \t\t\t\tname: 'merge',\n  \t\t\t\t// Although the `merge` lifecycle event shares its selection object\n  \t\t\t\t// with the `update` lifecycle event, the object's contents will be\n  \t\t\t\t// modified when d3.chart invokes the user-supplied `insert` method\n  \t\t\t\t// when triggering the `enter` event.\n  \t\t\t\tselection: bound\n  \t\t\t},\n  \t\t\t{\n  \t\t\t\tname: 'exit',\n  \t\t\t\t// Although the `exit` lifecycle event shares its selection object\n  \t\t\t\t// with the `update` and `merge` lifecycle events, the object's\n  \t\t\t\t// contents will be modified when d3.chart invokes\n  \t\t\t\t// `d3.selection.exit`.\n  \t\t\t\tselection: bound,\n  \t\t\t\tmethod: bound.exit\n  \t\t\t}\n  \t\t];\n\n  \t\tfor (var i = 0, l = events.length; i < l; ++i) {\n  \t\t\teventName = events[i].name;\n  \t\t\tselection = events[i].selection;\n  \t\t\tmethod = events[i].method;\n\n  \t\t\t// Some lifecycle selections modify shared state, so they must be\n  \t\t\t// deferred until just prior to handler invocation.\n  \t\t\tif (typeof method === 'function') {\n  \t\t\t\tselection = method.call(selection);\n  \t\t\t}\n\n  \t\t\tif (selection.empty()) {\n  \t\t\t\tcontinue;\n  \t\t\t}\n\n  \t\t\t// Although `selection instanceof d3.selection` is more explicit,\n  \t\t\t// it fails in IE8, so we use duck typing to maintain\n  \t\t\t// compatability.\n\n  \t\t\t// d3cAssert(selection &&\n  \t\t\t//   selection.call === d3.selection.prototype.call,\n  \t\t\t//   'Invalid selection defined for '' + eventName +\n  \t\t\t//   '' lifecycle event.');\n\n  \t\t\thandlers = this._handlers[eventName];\n\n  \t\t\tif (handlers) {\n  \t\t\t\tfor (idx = 0, len = handlers.length; idx < len; ++idx) {\n  \t\t\t\t\t// Attach a reference to the parent chart so the selection's\n  \t\t\t\t\t// `chart` method will function correctly.\n  \t\t\t\t\tselection._chart = handlers[idx].chart || this._base._chart;\n  \t\t\t\t\tselection.call(handlers[idx].callback);\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\thandlers = this._handlers[eventName + ':transition'];\n\n  \t\t\tif (handlers && handlers.length) {\n  \t\t\t\tselection = selection.transition();\n  \t\t\t\tfor (idx = 0, len = handlers.length; idx < len; ++idx) {\n  \t\t\t\t\tselection._chart = handlers[idx].chart || this._base._chart;\n  \t\t\t\t\tselection.call(handlers[idx].callback);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n  \t}\n  }\n\n  class Options {\n  \tconstructor(...options) {\n  \t\tvar i, key;\n  \t\tthis._options = options[0];\n\n  \t\tfor (i=1; i<options.length; i++) {\n  \t\t\tfor(key in options[i]) {\n  \t\t\t\tthis._options[key] = options[i][key];\n  \t\t\t}\n  \t\t}\n\n  \t}\n\n  \tget(name) {\n  \t\treturn this._options[name].value;\n  \t}\n\n  \tset(object) {\n  \t\tvar key;\n  \t\tfor (key in object) {\n  \t\t\tthis._options[key] = object[key];\n  \t\t}\n  \t\treturn this;\n  \t}\n\n  \tremove(name){\n  \t\tdelete this._options[name];\n  \t\treturn this;\n  \t}\n  }\n\n  class Koto {\n    constructor(Options, Layer, Chart) {\n      this._registry = {};\n\n      this.Options = Options;\n      this.Layer = Layer;\n      this.Chart = Chart;\n    }\n\n    chart(name, classFn) {\n      var baseChart;\n      if (arguments.length === 0) {\n        return this._registry;\n      } else if (arguments.length === 1) {\n        baseChart = this._registry[name];\n        baseChart.extends = function (childName, childClassFn) {\n          this._registry[childName] = childClassFn(this._registry[name]);\n        };\n        return baseChart;\n      } else {\n      \tthis._registry[name] = classFn(this.Chart);\n        return this._registry[name];\n      }\n    }\n  }\n\n  var koto = new Koto(Options, Layer, Chart);\n\n\n  //**********************************************************************************\n  // d3 extensions\n  //**********************************************************************************\n  d3.selection.prototype.chart = function(chartName, options) {\n    if (arguments.length === 0) {\n      return this._chart;\n    }\n    var ChartCtor = koto.chart(chartName);\n    return new ChartCtor(this, options);\n  };\n\n  d3.selection.enter.prototype.chart = function() {\n    return this._chart;\n  };\n\n  d3.transition.prototype.chart = d3.selection.enter.prototype.chart;\n\n  return koto;\n\n}));\n"],"sourceRoot":"/source/"}