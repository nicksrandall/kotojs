var _prototypeProperties=function(a,b,c){b&&Object.defineProperties(a,b),c&&Object.defineProperties(a.prototype,c)},_classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.koto=b()}(this,function(){"use strict";var a=function(){function a(b,c){_classCallCheck(this,a),this.base=b,this.hasDrawn=!1,this._layers={},this._attached={},this._events={},c&&c.transform&&(this.transform=c.transform)}return _prototypeProperties(a,null,{transform:{value:function(a){return a},writable:!0,configurable:!0},preDraw:{value:function(){},writable:!0,configurable:!0},postDraw:{value:function(){},writable:!0,configurable:!0},unlayer:{value:function(a){var b=this.layer(a);return delete this._layers[a],delete b._chart,b},writable:!0,configurable:!0},layer:{value:function b(a,c,d){var b;if(1===arguments.length)return this._layers[a];if(2===arguments.length){if("function"==typeof c.draw)return c._chart=this,this._layers[a]=c,this._layers[a];kotoAssert(!1,"When reattaching a layer, the second argument must be a d3.chart layer")}return b=c.layer(d),this._layers[a]=b,c._chart=this,b},writable:!0,configurable:!0},attach:{value:function(a,b){return 1===arguments.length?this._attached[a]:(this._attached[a]=b,b)},writable:!0,configurable:!0},draw:{value:function(a){var b,c,d,e=this.transform(a);this.preDraw(e);for(b in this._layers)this._layers[b].draw(e);for(c in this._attached)d=this.demux?this.demux(c,e):e,this._attached[c].draw(d);this.hasDrawn=!0,this.postDraw(e)},writable:!0,configurable:!0},on:{value:function(a,b,c){var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c||this,_chart:this}),this},writable:!0,configurable:!0},once:{value:function c(a,b,d){var e=this,c=function(){e.off(a,c),b.apply(this,arguments)};return this.on(a,c,d)},writable:!0,configurable:!0},off:{value:function(a,b,c){var d,e,f,g,h,i;if(0===arguments.length){for(a in this._events)this._events[a].length=0;return this}if(1===arguments.length)return f=this._events[a],f&&(f.length=0),this;for(d=a?[a]:Object.keys(this._events),h=0;h<d.length;h++)for(e=d[h],f=this._events[e],i=f.length;i--;)g=f[i],(b&&b===g.callback||c&&c===g.context)&&f.splice(i,1);return this},writable:!0,configurable:!0},trigger:{value:function(a){var b,c,d=Array.prototype.slice.call(arguments,1),e=this._events[a];if(void 0!==e)for(b=0;b<e.length;b++)c=e[b],c.callback.apply(c.context,d);return this},writable:!0,configurable:!0}}),a}(),b=/^(enter|update|merge|exit)(:transition)?$/,c=function(){function a(b){_classCallCheck(this,a),this._base=b,this._handlers={}}return _prototypeProperties(a,null,{dataBind:{value:function(){kotoAssert(!1,"Layers must specify a dataBind method.")},writable:!0,configurable:!0},insert:{value:function(){kotoAssert(!1,"Layers must specify an `insert` method.")},writable:!0,configurable:!0},on:{value:function(a,c,d){return d=d||{},kotoAssert(b.test(a),"Unrecognized lifecycle event name specified to `Layer#on`: '${eventName}'."),a in this._handlers||(this._handlers[a]=[]),this._handlers[a].push({callback:c,chart:d.chart||null}),this._base},writable:!0,configurable:!0},off:{value:function(a,c){var d,e=this._handlers[a];if(kotoAssert(b.test(a),"Unrecognized lifecycle event name specified to `Layer#on`: '${eventName}'."),!e)return this._base;if(1===arguments.length)return e.length=0,this._base;for(d=e.length-1;d>-1;--d)e[d].callback===c&&e.splice(d,1);return this._base},writable:!0,configurable:!0},draw:{value:function(a){var b,c,d,e,f,g,h,i,j;b=this.dataBind.call(this._base,a),c=b.enter(),c._chart=this._base._chart,d=[{name:"update",selection:b},{name:"enter",selection:c,method:this.insert},{name:"merge",selection:b},{name:"exit",selection:b,method:b.exit}];for(var k=0,l=d.length;l>k;++k)if(h=d[k].name,e=d[k].selection,f=d[k].method,"function"==typeof f&&(e=f.call(e)),!e.empty()){if(g=this._handlers[h])for(i=0,j=g.length;j>i;++i)e._chart=g[i].chart||this._base._chart,e.call(g[i].callback);if(g=this._handlers[h+":transition"],g&&g.length)for(e=e.transition(),i=0,j=g.length;j>i;++i)e._chart=g[i].chart||this._base._chart,e.call(g[i].callback)}},writable:!0,configurable:!0}}),a}(),d=function(){function a(){for(var b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];_classCallCheck(this,a);var e,f;for(this._options=c[0],e=1;e<c.length;e++)for(f in c[e])this._options[f]=c[e][f]}return _prototypeProperties(a,null,{get:{value:function(a){return this._options[a].value},writable:!0,configurable:!0},set:{value:function(a){var b;for(b in a)this._options[b]=a[b];return this},writable:!0,configurable:!0},remove:{value:function(a){return delete this._options[a],this},writable:!0,configurable:!0}}),a}(),e=function(){function a(b,c,d){_classCallCheck(this,a),this._registry={},this.Options=b,this.Layer=c,this.Chart=d}return _prototypeProperties(a,null,{chart:{value:function(a,b){var c;return 0===arguments.length?this._registry:1===arguments.length?(c=this._registry[a],c["extends"]=function(b,c){this._registry[b]=c(this._registry[a])},c):(this._registry[a]=b(this.Chart),this._registry[a])},writable:!0,configurable:!0}}),a}(),f=new e(d,c,a);return d3.selection.prototype.chart=function(a,b){if(0===arguments.length)return this._chart;var c=f.chart(a);return new c(this,b)},d3.selection.enter.prototype.chart=function(){return this._chart},d3.transition.prototype.chart=d3.selection.enter.prototype.chart,f});
//# sourceMappingURL=koto.min.js.map